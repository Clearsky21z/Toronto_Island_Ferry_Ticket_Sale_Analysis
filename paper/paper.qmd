---
title: "Analyzing Temporal Patterns and Passenger Flow in Toronto Island Ferry Ticket Sales"
subtitle: "A Time Series Approach"
author: 
  - John Zhang
thanks: "Code and data are available at: https://github.com/Clearsky21z/Toronto_Island_Ferry_Ticket_Sale_Analysis."
date: today
date-format: long
toc: true
abstract: "This paper analyzes Toronto Island ferry ticket sales over a specific period, focusing on time series patterns and passenger flow trends. By examining both sales and redemptions data at 15-minute intervals, we uncover daily and seasonal trends in ferry usage. These insights can help optimize ferry operations and enhance visitor experience. The analysis highlights peak times of demand and usage variations over different seasons."
format: pdf
number-sections: true
bibliography: references.bib
nocite: '@*'
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(opendatatoronto)
library(knitr)
library(lubridate)

#### Load the dataset ####
raw_data <- read_csv(here::here("data/raw_data/unedited_ferry_ticket_counts.csv"))
validated_data <- read_csv(here::here("data/analysis_data/validated_ferry_ticket_counts.csv"))

#### Extract year, month, and day of the week for trend analysis ####
validated_data <- validated_data %>%
  mutate(
    date = as_date(timestamp),
    year = year(date),
    month = month(date, label = TRUE),
    week = week(date),
    day_of_week = wday(date, label = TRUE),
    hour = hour(timestamp)
  )

```


# Introduction
Toronto Island Park is a popular recreational destination for residents and tourists alike, situated in Lake Ontario just off the coast of downtown Toronto. Accessible primarily via ferries, the park includes several islands such as Centre Island, Hanlan’s Point, and Ward’s Island. These islands offer a variety of activities, including beaches, nature reserves, trails, and historical landmarks like the Gibraltar Point Lighthouse. The park’s popularity peaks during the summer months, when visitors flock to its beaches and recreational facilities.

Ferry transportation to and from the islands is operated year-round by the Jack Layton Ferry Terminal. Passengers can purchase ferry tickets either online or at point-of-sale (POS) kiosks at the terminal, with the tickets covering both the outbound and return journeys. Online ticket holders benefit from separate boarding lines during peak times, which helps ease congestion. Although ferries run throughout the year, demand is highest on weekends, holidays, and during the summer months, with the busiest travel periods typically between 10 a.m. and 2 p.m. for trips to the islands and from 5:30 p.m. to 9 p.m. for return trips to the city. The ferry route from Centre Island sees the most traffic, and wait times for the return trip can exceed an hour during peak periods.

Given the significant variation in ferry demand throughout the year and at different times of the day, analyzing ferry ticket sales data provides valuable insights into temporal patterns of ferry usage. Understanding these patterns can help optimize ferry schedules, manage peak loads, and improve the overall passenger experience. This paper uses time series analysis to investigate ferry ticket sales and redemptions, exploring daily, weekly, and monthly trends, seasonal patterns, peak usage times, and the busiest days of the year.

The remainder of the paper is structured as follows. @sec-data introduces the dataset and its source, as well as key variables used in the analysis. @sec-result presents the findings from the time series analysis, including trend detection, seasonality, and peak times of usage. @sec-disc provides a discussion of these results, highlighting key insights and offering suggestions for future work.


# Data {#sec-data}
The dataset for this analysis was obtained from Open Data Toronto, which provides real-time ferry ticket sales and redemption counts for the Toronto Island Ferry system. The data covers ticket sales and redemptions at 15-minute intervals, including both online and point-of-sale (POS) kiosk sales. It contains information on ferry activity to and from Centre Island, Hanlan’s Point, and Ward’s Island. This dataset is particularly valuable for understanding ferry demand patterns and optimizing operations to meet passenger flow during peak times.

## Raw Data
The raw dataset starts from July 2015 and continues to the most recent available date. For the purpose of this analysis, I focused on complete years of data between 2016 and 2023, to avoid incomplete yearly trends. The original raw dataset consists of four columns:

1. X_id: An identifier for each record.
2. Timestamp: The date and time when the ferry transaction was recorded, stored at 15-minute intervals.
3. Redemption_Count: The number of ferry tickets redeemed in each 15-minute interval.
4. Sales_Count: The number of ferry tickets sold in each 15-minute interval.

@tbl-table1 is a sample of the raw data using head() to show the structure and contents of the dataset. As seen, each row represents the ferry ticket activity for a specific 15-minute interval, showing the timestamp, number of redemptions, and the number of sales.

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: tbl-table1
#| tbl-cap: Sample of Raw Data

raw_data_sample <- head(raw_data)
kable(
  raw_data_sample,
  col.names = c("X_id", "Timestamp", "Redemption_Count", "Sales_Count")
)

```


## Modifications and Reasoning
### Filtering for Full-Year Data (2016-2023)
To provide a more comprehensive analysis and to avoid the issues that arise from incomplete data, such as partially recorded years, I filtered the dataset to include only the full-year data from 2016 to 2023. This allows for more consistent year-over-year comparisons and avoids the distortion of trends that could result from partial data (e.g., incomplete months in 2015 or the current year).

### Adding a "Total Sales" Column
In the original dataset, sales and redemption data were recorded in separate columns, which made it harder to quickly assess the total ferry ticket activity. To streamline the analysis, I created an additional column called Total_Sales, which is simply the sum of Redemption_Count and Sales_Count. This new column allows for faster aggregate comparisons and simplifies the time series analysis.

### Extracting Date Components from Timestamps
To facilitate time series analysis, I extracted several useful features from the Timestamp column, such as year, month, week, day of the week, and hour. These features allow for granular analysis of patterns over time, including daily, weekly, and seasonal trends. This extraction makes it easier to analyze peak times and demand variations by breaking down the timestamp into relevant components.

@tbl-table2 shows a sample of modified data.
```{r}
#| echo: false
#| warning: false
#| message: false
#| label: tbl-table2
#| tbl-cap: Sample of Modified Data

modified_data_sample <- head(validated_data)

kable(
  modified_data_sample,
  col.names = c("ID", "Timestamp", "Redemption Count", "Sales Count", "Total Sales", "Date", "Year", "Month", "Week", "Day of Week", "Hour")
)
```


# Result {#sec-result}
## Trend Detection: Daily, Monthly, and Seasonal Patterns
The analysis of daily ferry ticket sales reveals clear patterns of visitor flow throughout the year. As illustrated in @fig-figure1, ticket sales for 2023 peak prominently during the summer months of June to August, with noticeable spikes during weekends. This trend emphasizes the importance of the Toronto Islands as a leisure destination, particularly during the warmer months when outdoor activities are in high demand.

In @fig-figure2, the monthly trends further confirm the significant increase in ferry usage during the summer months. The highest peaks are observed in July and August across multiple years, reinforcing the idea that ferry demand is closely linked to the tourism and recreational seasons. This pattern is consistent year-over-year, with slight variations depending on external factors such as public events, holidays, and the influence of the COVID-19 pandemic in certain years.

The seasonality of ferry ticket sales is a vital insight for operational planning, as it highlights the months where additional resources and staffing are required to meet the increased demand. Conversely, the sharp decline in sales during the winter months suggests that resources can be scaled back during the off-season to optimize operational efficiency.
```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-figure1
#| fig-cap: Daily Ferry Ticket Sales in 2023

#### Daily Sales Summarization ####
#### Filter for the year 2023 ####
validated_data_2023 <- validated_data %>%
  mutate(date = as_date(timestamp)) %>%
  filter(year(date) == 2023)

#### Summarize daily sales for 2023 ####
daily_sales_2023 <- validated_data_2023 %>%
  group_by(date) %>%
  summarize(total_sales = sum(total_sales))

#### Plot daily sales trend for 2023 with custom x-axis labels ####
ggplot(daily_sales_2023, aes(x = date, y = total_sales)) +
  geom_line(color = "blue") +
  labs(title = "Daily Ferry Ticket Sales in 2023", x = "Date", y = "Total Sales") +
  scale_x_date(
    breaks = as.Date(c("2023-01-01", "2023-04-01", "2023-07-01", "2023-10-01", "2023-12-31")),
    labels = c("Jan 2023", "Apr 2023", "Jul 2023", "Oct 2023", "Dec 2023")
  ) +
  theme_minimal()
```

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-figure2
#| fig-cap: Monthly Trends in Ferry Ticket Sales

#### Monthly Seasonality - Aggregating by month ####
monthly_sales <- validated_data %>%
  group_by(year, month) %>%
  summarise(total_sales = sum(total_sales))

ggplot(monthly_sales, aes(x = month, y = total_sales, group = year, color = factor(year))) +
  geom_line(size = 1) +
  theme_minimal() +
  labs(title = "Monthly Trends in Ferry Ticket Sales",
       x = "Month",
       y = "Total Sales") +
  scale_color_brewer(palette = "Set1", name = "Year")
```

## Passenger Flow: Peak Time Identification
The analysis of hourly ferry ticket sales, as shown in @fig-figure3, provides a detailed view of passenger flow throughout the day. The peak time for ferry ticket sales occurs between 10 a.m. and 3 p.m., reflecting the tendency of visitors to travel to the islands during late mornings and early afternoons. A secondary, smaller peak occurs in the late afternoon, as visitors return to the city.

This information is critical for ferry operators to adjust their schedules and staffing levels to accommodate peak passenger loads, especially during summer weekends. By anticipating these high-traffic periods, ferry operations can be more responsive to demand, reducing wait times and improving the overall passenger experience.

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-figure3
#| fig-cap: Hourly Ferry Ticket Sales
#### Hourly Sales (Peak Time Identification) ####
# Summarize hourly sales
hourly_sales <- validated_data %>%
  group_by(hour) %>%
  summarize(total_sales = sum(total_sales))

# Plot hourly sales trend
ggplot(hourly_sales, aes(x = hour, y = total_sales)) +
  geom_line(color = "darkgreen") +
  labs(title = "Hourly Ferry Ticket Sales", x = "Hour of the Day", y = "Total Sales") +
  theme_minimal()
```

## Day-of-Week Analysis
As shown in @fig-figure4, ferry usage is consistently higher on weekends, with Saturdays and Sundays being the busiest days across all years. This pattern is driven by recreational visitors, families, and tourists who tend to visit the Toronto Islands during their leisure time.

This day-of-week analysis emphasizes the need for strategic scheduling and additional ferry services during weekends to avoid congestion and manage the large influx of passengers. Moreover, understanding the day-of-week patterns can help operators allocate resources more effectively and improve customer service during peak times.

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: fig-figure4
#| fig-cap: Ferry Ticket Sales by Day of the Week

#### Day of Week Analysis ####
# Summarize sales by day of the week
weekly_sales <- validated_data %>%
  group_by(day_of_week) %>%
  summarize(total_sales = sum(total_sales))

# Plot sales by day of the week
ggplot(weekly_sales, aes(x = day_of_week, y = total_sales)) +
  geom_bar(stat = "identity", fill = "orange") +
  labs(title = "Ferry Ticket Sales by Day of the Week", x = "Day of the Week", y = "Total Sales") +
  theme_minimal()
```

## Peak Day Analysis
The peak day analysis, presented in @tbl-table3, highlights the specific days of the year with the highest ferry ticket sales. These peak days often coincide with public holidays, long weekends, or major summer events. For instance, August 1, 2016, and August 20, 2017, mark notable peaks in ferry ticket sales, likely driven by holiday-related traffic.

Understanding these peak days is crucial for operational planning. During these high-demand days, ferry operators can anticipate higher passenger loads and prepare accordingly by increasing the number of ferry trips, deploying additional staff, and improving crowd management strategies. By proactively addressing these surges in demand, ferry operations can ensure a smoother and more enjoyable experience for passengers.

```{r}
#| echo: false
#| warning: false
#| message: false
#| label: tbl-table3
#| tbl-cap: Peak Day for Each Year Based on Total Sales

#### Peak Day Analysis ####
# Summarize total sales for each day
daily_sales <- validated_data %>%
  group_by(year, date) %>%
  summarize(total_sales = sum(total_sales), .groups = "drop")

# Find the day with the most sales for each year
peak_days <- daily_sales %>%
  group_by(year) %>%
  filter(total_sales == max(total_sales)) %>%
  ungroup()

# Output the result as a knitr table
peak_days %>%
  arrange(year) %>%
  kable(col.names = c("Year", "Peak Day", "Total Sales"))
```


# Discussion {#sec-disc}
## Key Insights and Implications
1. Seasonal and Monthly Trends: The analysis confirms the strong seasonality in ferry ticket sales, with the highest demand occurring in the summer months of July and August. This seasonal spike is closely tied to tourism and recreational activities on the Toronto Islands, particularly during holidays and weekends. The sharp contrast in sales between the summer and winter months highlights the importance of efficient resource allocation, ensuring that operations can scale up during peak seasons and down during the off-season.

2. Daily and Hourly Passenger Flow: Peak ferry traffic is concentrated between late morning and early afternoon, with a significant surge in sales between 10 a.m. and 3 p.m. on weekends. These insights provide actionable recommendations for ferry operators to adjust their schedules to minimize wait times during these high-demand hours. By aligning ferry trips with peak demand, operators can ensure that passengers experience shorter lines and faster service.

3. Day-of-Week Trends: The consistent pattern of increased ferry sales on Saturdays and Sundays suggests that weekends remain the primary travel time for both local visitors and tourists. This insight underscores the need for operational adjustments on weekends, including more frequent ferry trips, extended service hours, and enhanced crowd management.

4. Peak Day Analysis: The identification of peak days, typically aligned with holidays or major summer events, provides valuable information for managing extraordinary surges in passenger demand. By knowing in advance which days are likely to experience the highest traffic, ferry operators can implement targeted strategies to handle the increased load, such as adding extra ferry trips or implementing temporary crowd control measures.

## Weaknesses and Future Directions
One notable limitation of this analysis is the absence of external factors such as weather conditions, which can significantly influence daily ferry usage. For example, rainy days or extreme heat may deter visitors, while sunny weekends could lead to unexpectedly high demand. Incorporating weather data into future analyses could provide more accurate predictions of ferry traffic patterns.

Additionally, the lack of demographic data prevents a deeper understanding of the types of passengers using the ferry service. By integrating demographic insights, such as age groups, tourist vs. local usage, or family vs. individual travelers, ferry operators could tailor their services to meet the specific needs of different customer segments.

Future research should also explore predictive modeling, using historical data to forecast future ferry demand based on a combination of seasonal patterns, event schedules, and weather forecasts. Such models could help operators anticipate peak days and hours more accurately, allowing for better preparedness and service delivery.

By addressing these gaps and building on the existing analysis, ferry operators can continue to enhance their services, improving the overall experience for visitors to the Toronto Islands.

\newpage

\appendix

# Appendix {#sec-appendix}
## Dataset and Graph Sketches
Sketches of the desired dataset structure and the visualizations created for analysis are available in the GitHub repository. These sketches illustrate the different time intervals and patterns analyzed in the report.

## Data Cleaning
The data cleaning process involved the following steps to ensure the accuracy and integrity of the dataset:

Duplicate Removal: Any duplicate entries, particularly those with identical timestamps, were removed to ensure data accuracy.
Missing Values: Rows with missing values in key fields (timestamp, redemption count, and sales count) were eliminated to maintain the completeness of the dataset.
Validation of Positive Values: Ensured that both redemption_count and sales_count contained only non-negative integers.
No modifications to the actual data content were made beyond these cleaning steps.

## Data Testing
The following tests were applied to the cleaned dataset to ensure its quality and consistency:

- Redemption and sales counts: All redemption_count and sales_count values were checked to ensure they are non-negative.
- Total sales validation: A derived column, total_sales, was checked to ensure that all values are non-negative, as it represents the sum of redemption_count and sales_count.
- Timestamp validation: Ensured that all timestamps fall within the expected range (from 2016 to 2023).
- Duplicate records check: Verified that there are no duplicate entries for the same timestamp.
- Missing values check: Ensured that there are no missing values in the key columns: timestamp, redemption_count, and sales_count.
Results from the tests are shown in @tbl-data-testing below:
```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-data-testing
#| tbl-cap: "Data Testing Results"

# Create the test results data frame
test_results <- data.frame(
  `Test Description` = c("All redemption counts non-negative",
                         "All sales counts non-negative",
                         "All total sales non-negative",
                         "All timestamps within valid range",
                         "No duplicate timestamps",
                         "No missing values in key columns"),
  Result = c("Passed", "Passed", "Passed", "Passed", "Passed", "Passed")
)

# Produce the table using knitr
kable(test_results, col.names = c("Test Description", "Result"))
```


## Attribution Statement
“Contains information licensed under the Open Government Licence – Toronto” (City of Toronto, n.d.b).

This appendix clearly outlines the data cleaning and testing process, ensuring the dataset's reliability for subsequent analysis without mentioning any data modification.



\newpage


# References


